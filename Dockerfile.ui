# Dockerfile.ui — Dash on port 8050
FROM python:3.11-slim

# System deps
RUN apt-get update && apt-get install -y --no-install-recommends tini curl \
 && rm -rf /var/lib/apt/lists/*

WORKDIR /app

# Install your existing deps if present
COPY requirements.txt /app/requirements.txt
RUN pip install --no-cache-dir -r /app/requirements.txt || true

# Ensure Dash + gunicorn + bootstrap components are there
RUN pip install --no-cache-dir dash==2.17.* gunicorn==22.* dash-bootstrap-components

# Copy your full project into the image
COPY . /app

EXPOSE 8050

# Entry point — use gunicorn to serve your Dash app
# IMPORTANT: module path points at ids_unsw/ui/app_dash.py
# Inside that file you must have: app = Dash(__name__); server = app.server
CMD ["gunicorn", "-b", "0.0.0.0:8050", "ids_unsw.ui.app_dash:server"]
